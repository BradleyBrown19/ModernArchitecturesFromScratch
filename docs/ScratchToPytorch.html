---

title: ScratchToPytorch

keywords: fastai
sidebar: home_sidebar

summary: "The goal for this project from this point on is to shift away from implementing everything from scratch and using things that we've already built from PyTorch to take advantage of the C speed that makes us able to perform our own experiments and iterate quickly"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: ScratchToPytorch.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_imaggenette" class="doc_header"><code>get_imaggenette</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/scratch_to_pytorch.py#L21" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_imaggenette</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CustomLearner" class="doc_header"><code>class</code> <code>CustomLearner</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/scratch_to_pytorch.py#L27" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CustomLearner</code>(<strong><code>model</code></strong>, <strong><code>loss_func</code></strong>, <strong><code>optimizer</code></strong>, <strong><code>db</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_learner" class="doc_header"><code>get_learner</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/callbacks_05.py#L73" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_learner</code>()</p>
</blockquote>
<p>Helper function to get learner</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_runner" class="doc_header"><code>get_runner</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/callbacks_05.py#L159" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_runner</code>(<strong><code>callbacks</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ProgressCallback" class="doc_header"><code>class</code> <code>ProgressCallback</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/callbacks_05.py#L422" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ProgressCallback</code>() :: <a href="/ModernArchitecturesFromScratch/Callbacks#Callback"><code>Callback</code></a></p>
</blockquote>
<p>Callback to make a nice progress bar with metrics for training. Slightly modified version of: <a href="https://github.com/fastai/course-v3/blob/master/nbs/dl2/09c_add_progress_bar.ipynb">https://github.com/fastai/course-v3/blob/master/nbs/dl2/09c_add_progress_bar.ipynb</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TrainEvalCallback" class="doc_header"><code>class</code> <code>TrainEvalCallback</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/callbacks_05.py#L173" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TrainEvalCallback</code>() :: <a href="/ModernArchitecturesFromScratch/Callbacks#Callback"><code>Callback</code></a></p>
</blockquote>
<p>Keeps track of training/eval mode of model and progress through training</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="accuracy" class="doc_header"><code>accuracy</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/callbacks_05.py#L340" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>accuracy</code>(<strong><code>preds</code></strong>, <strong><code>targ</code></strong>, <strong>*<code>args</code></strong>)</p>
</blockquote>
<p>Compute accuracy of <code>preds</code> with respect to <code>targ</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CudaCallback" class="doc_header"><code>class</code> <code>CudaCallback</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/scratch_to_pytorch.py#L82" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CudaCallback</code>() :: <a href="/ModernArchitecturesFromScratch/Callbacks#Callback"><code>Callback</code></a></p>
</blockquote>
<p>Base class for callbacks, defines order of execution and allows abstraction of self to runner class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Runner" class="doc_header"><code>class</code> <code>Runner</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/callbacks_05.py#L80" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Runner</code>(<strong><code>learner</code></strong>, <strong><code>cbs</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>All encompossing class to train a model with specific callbacks</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>python notebook2script.py ScratchToPytorch.ipynb
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted ScratchToPytorch.ipynb to ModernArchitecturesFromPyTorch/nb_ScratchToPytorch.py
</pre>
</div>
</div>

</div>
</div>

</div>
</div>
 

