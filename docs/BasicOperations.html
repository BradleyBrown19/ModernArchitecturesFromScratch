---

title: Title

keywords: fastai
sidebar: home_sidebar

summary: "summary"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: BasicOperations.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Data-and-Visualization">Data and Visualization<a class="anchor-link" href="#Data-and-Visualization">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_equal" class="doc_header"><code>is_equal</code><a href="https://github.com/BradleyBrown19/ModernArchitecuturesFromScratch/tree/master/ModernArchitecuturesFromScratch/basic_operations_01.py#L24" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_equal</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">download_data</span><span class="p">(</span><span class="n">MNIST_URL</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;.gz&#39;</span><span class="p">);</span> <span class="n">path</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>PosixPath(&#39;/Users/bradleybrown/.fastai/data/mnist.pkl.gz&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="p">((</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">),</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_valid</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="show_im" class="doc_header"><code>show_im</code><a href="https://github.com/BradleyBrown19/ModernArchitecuturesFromScratch/tree/master/ModernArchitecuturesFromScratch/basic_operations_01.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>show_im</code>(<strong><code>image</code></strong>, <strong><code>size</code></strong>=<em><code>28</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_im</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="near" class="doc_header"><code>near</code><a href="https://github.com/BradleyBrown19/ModernArchitecuturesFromScratch/tree/master/ModernArchitecuturesFromScratch/basic_operations_01.py#L36" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>near</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="test_near" class="doc_header"><code>test_near</code><a href="https://github.com/BradleyBrown19/ModernArchitecuturesFromScratch/tree/master/ModernArchitecuturesFromScratch/basic_operations_01.py#L37" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>test_near</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Matmul">Matmul<a class="anchor-link" href="#Matmul">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_weight</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ims</span> <span class="o">=</span> <span class="n">x_train</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">ground_truth</span> <span class="o">=</span> <span class="n">ims</span> <span class="o">@</span> <span class="n">test_weight</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">matmul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">ar</span><span class="p">,</span> <span class="n">ac</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">br</span><span class="p">,</span> <span class="n">bc</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">ac</span> <span class="o">==</span> <span class="n">br</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span><span class="n">bc</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">bc_in</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bc</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ar_in</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ar</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ac_in</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ac</span><span class="p">):</span>
                <span class="n">c</span><span class="p">[</span><span class="n">ar_in</span><span class="p">][</span><span class="n">bc_in</span><span class="p">]</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">ar_in</span><span class="p">][</span><span class="n">ac_in</span><span class="p">]</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="n">ac_in</span><span class="p">][</span><span class="n">bc_in</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">c</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> c = matmul(ims,test_weight)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 664 ms, sys: 1.73 ms, total: 666 ms
Wall time: 666 ms
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_near</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">ground_truth</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>good
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">matmul2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">ar</span><span class="p">,</span> <span class="n">ac</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">br</span><span class="p">,</span> <span class="n">bc</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">ac</span> <span class="o">==</span> <span class="n">br</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span><span class="n">bc</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">bc_in</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bc</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ar_in</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ar</span><span class="p">):</span>
                <span class="n">c</span><span class="p">[</span><span class="n">ar_in</span><span class="p">][</span><span class="n">bc_in</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">ar_in</span><span class="p">,:]</span><span class="o">*</span><span class="n">b</span><span class="p">[:,</span><span class="n">bc_in</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">c</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> c2 = matmul2(ims,test_weight)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 3.58 ms, sys: 1.7 ms, total: 5.28 ms
Wall time: 3.57 ms
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_near</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span><span class="n">ground_truth</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>good
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">matmul3</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">ar</span><span class="p">,</span> <span class="n">ac</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">br</span><span class="p">,</span> <span class="n">bc</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">ac</span> <span class="o">==</span> <span class="n">br</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span><span class="n">bc</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ar_in</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ar</span><span class="p">):</span>
        <span class="n">c</span><span class="p">[</span><span class="n">ar_in</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">ar_in</span><span class="p">]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">c</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> c3 = matmul3(ims,test_weight)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 768 µs, sys: 625 µs, total: 1.39 ms
Wall time: 729 µs
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> <span class="n">test_near</span><span class="p">(</span><span class="n">c3</span><span class="p">,</span><span class="n">ground_truth</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>good
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="matmul4" class="doc_header"><code>matmul4</code><a href="https://github.com/BradleyBrown19/ModernArchitecuturesFromScratch/tree/master/ModernArchitecuturesFromScratch/basic_operations_01.py#L44" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>matmul4</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> c4 = matmul4(ims, test_weight)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 194 µs, sys: 46 µs, total: 240 µs
Wall time: 184 µs
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="k">import</span> <span class="o">*</span>
<span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted AdvancedTrainingLoop.ipynb.
Converted BasicOperations.ipynb.
Converted Convolutions and Pooling.ipynb.
Converted FullyConnectedNetwork.ipynb.
Converted TrainingLoop.ipynb.
Converted index.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
</div>
 

