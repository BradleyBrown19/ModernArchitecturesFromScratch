---

title: Basic Operations

keywords: fastai
sidebar: home_sidebar

summary: "Fundamental operations and helper functions in use throughout the library"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: basic_operations.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Helper-Functions">Helper Functions<a class="anchor-link" href="#Helper-Functions">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Testing">Testing<a class="anchor-link" href="#Testing">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_equal" class="doc_header"><code>is_equal</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L26" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_equal</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>
<p>Test for equality between <code>a</code> and <code>b</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="near" class="doc_header"><code>near</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L32" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>near</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>
<p>Test if tensors <code>a</code> and <code>b</code> are the same within a small tolerance</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="test_near" class="doc_header"><code>test_near</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L37" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>test_near</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>
<p>Test if tensors <code>a</code> and <code>b</code> are near within a small tolerance</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="test_near_zero" class="doc_header"><code>test_near_zero</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L45" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>test_near_zero</code>(<strong><code>data</code></strong>, <strong><code>tol</code></strong>=<em><code>0.001</code></em>)</p>
</blockquote>
<p>Tests if tensor values are near zero under given 'tol'</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_near</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>not near
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_near</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>good
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_near_zero</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Near zero: 0.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Loading">Data Loading<a class="anchor-link" href="#Data-Loading">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="normalize" class="doc_header"><code>normalize</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L50" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>normalize</code>(<strong><code>datasets</code></strong>, <strong><code>mean</code></strong>=<em><code>None</code></em>, <strong><code>std</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Normalizes according to given 'mean' and 'std' or mean of std of datasets if none given</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_mnist" class="doc_header"><code>get_mnist</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L57" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_mnist</code>()</p>
</blockquote>
<p>Helper function to load <code>normalized</code> train and validation MNIST datasets</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_mnist</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">download_data</span><span class="p">(</span><span class="n">MNIST_URL</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;.gz&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="p">((</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">),</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>

    <span class="n">xt</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span><span class="n">xv</span><span class="p">,</span><span class="n">yv</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">normalize</span><span class="p">(</span><span class="n">xt</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">(),</span> <span class="n">yt</span><span class="o">.</span><span class="n">float</span><span class="p">(),</span> <span class="n">normalize</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">xt</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">xt</span><span class="o">.</span><span class="n">std</span><span class="p">())</span><span class="o">.</span><span class="n">float</span><span class="p">(),</span> <span class="n">yv</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xt</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span><span class="n">xv</span><span class="p">,</span><span class="n">yv</span> <span class="o">=</span> <span class="n">get_mnist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_stats" class="doc_header"><code>get_stats</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_stats</code>(<strong><code>data</code></strong>)</p>
</blockquote>
<p>Print mean and standard deviation of given <code>data</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_stats</span><span class="p">(</span><span class="n">xt</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean: 0.00012300178059376776
Std: 1.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Visualization">Visualization<a class="anchor-link" href="#Visualization">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="show_im" class="doc_header"><code>show_im</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L77" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>show_im</code>(<strong><code>image</code></strong>, <strong><code>size</code></strong>=<em><code>28</code></em>)</p>
</blockquote>
<p>Displays 'image' or random 'image' from set if multiple given of given 'size'</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_im</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Matmul">Matmul<a class="anchor-link" href="#Matmul">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="matmul" class="doc_header"><code>matmul</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L85" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>matmul</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>
<p>Perform matrix multiplication on <code>a</code> and <code>b</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">matmul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">ar</span><span class="p">,</span> <span class="n">ac</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">br</span><span class="p">,</span> <span class="n">bc</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">ac</span> <span class="o">==</span> <span class="n">br</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span><span class="n">bc</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ar_in</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ar</span><span class="p">):</span>
        <span class="n">c</span><span class="p">[</span><span class="n">ar_in</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">ar_in</span><span class="p">]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">c</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> result = matmul(ims,test_weight)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 506 µs, sys: 337 µs, total: 843 µs
Wall time: 487 µs
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_near</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="n">ground_truth</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>good
</pre>
</div>
</div>

</div>
</div>

</div>
</div>
 

