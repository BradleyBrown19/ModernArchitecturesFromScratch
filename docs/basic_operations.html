---

title: Basic Operations

keywords: fastai
sidebar: home_sidebar

summary: "Fundamental operations and helper functions in use throughout the library"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: basic_operations.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Helper-Functions-and-Visualization">Helper Functions and Visualization<a class="anchor-link" href="#Helper-Functions-and-Visualization">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Equality-Testing">Equality Testing<a class="anchor-link" href="#Equality-Testing">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_equal" class="doc_header"><code>is_equal</code><a href="https://github.com/BradleyBrown19/ModernArchitecuturesFromScratch/tree/master/ModernArchitecuturesFromScratch/basic_operations_01.py#L24" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_equal</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>
<p>Test for equality between <code>a</code> and <code>b</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="near" class="doc_header"><code>near</code><a href="https://github.com/BradleyBrown19/ModernArchitecuturesFromScratch/tree/master/ModernArchitecuturesFromScratch/basic_operations_01.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>near</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>
<p>Test if tensors <code>a</code> and <code>b</code> are the same within a small tolerance</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="test_near" class="doc_header"><code>test_near</code><a href="https://github.com/BradleyBrown19/ModernArchitecuturesFromScratch/tree/master/ModernArchitecuturesFromScratch/basic_operations_01.py#L34" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>test_near</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>
<p>API for testing if tensors are near</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Visualization">Visualization<a class="anchor-link" href="#Visualization">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="show_im" class="doc_header"><code>show_im</code><a href="https://github.com/BradleyBrown19/ModernArchitecuturesFromScratch/tree/master/ModernArchitecuturesFromScratch/basic_operations_01.py#L46" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>show_im</code>(<strong><code>image</code></strong>, <strong><code>size</code></strong>=<em><code>28</code></em>)</p>
</blockquote>
<p>Displays 'image' or random 'image' from set if multiple given of given 'size'</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_im</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Matmul">Matmul<a class="anchor-link" href="#Matmul">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="matmul" class="doc_header"><code>matmul</code><a href="https://github.com/BradleyBrown19/ModernArchitecuturesFromScratch/tree/master/ModernArchitecuturesFromScratch/basic_operations_01.py#L54" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>matmul</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>
<p>Perform matrix multiplication on <code>a</code> and <code>b</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="c1">#export</span>
<span class="k">def</span> <span class="nf">matmul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">ar</span><span class="p">,</span> <span class="n">ac</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">br</span><span class="p">,</span> <span class="n">bc</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">ac</span> <span class="o">==</span> <span class="n">br</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span><span class="n">bc</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ar_in</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ar</span><span class="p">):</span>
        <span class="n">c</span><span class="p">[</span><span class="n">ar_in</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">ar_in</span><span class="p">]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">c</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> result = matmul(ims,test_weight)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 768 µs, sys: 625 µs, total: 1.39 ms
Wall time: 729 µs
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_near</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="n">ground_truth</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>good
</pre>
</div>
</div>

</div>
</div>

</div>
</div>
 

