---

title: Basic Operations

keywords: fastai
sidebar: home_sidebar

summary: "Fundamental operations and helper functions in use throughout the library"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: basic_operations.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Helper-Functions">Helper Functions<a class="anchor-link" href="#Helper-Functions">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Testing">Testing<a class="anchor-link" href="#Testing">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_equal" class="doc_header"><code>is_equal</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L26" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_equal</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>
<p>Test for equality between <code>a</code> and <code>b</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="near" class="doc_header"><code>near</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L32" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>near</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>
<p>Test if tensors <code>a</code> and <code>b</code> are the same within a small tolerance</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="test_near" class="doc_header"><code>test_near</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L37" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>test_near</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>
<p>Test if tensors <code>a</code> and <code>b</code> are near within a small tolerance</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="test_near_zero" class="doc_header"><code>test_near_zero</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L45" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>test_near_zero</code>(<strong><code>data</code></strong>, <strong><code>tol</code></strong>=<em><code>0.001</code></em>)</p>
</blockquote>
<p>Tests if tensor values are near zero under given 'tol'</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_near</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>not near
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_near</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>good
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_near_zero</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Near zero: 0.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Loading">Data Loading<a class="anchor-link" href="#Data-Loading">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="normalize" class="doc_header"><code>normalize</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L50" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>normalize</code>(<strong><code>datasets</code></strong>, <strong><code>mean</code></strong>=<em><code>None</code></em>, <strong><code>std</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Normalizes according to given 'mean' and 'std' or mean of std of datasets if none given</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_mnist" class="doc_header"><code>get_mnist</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L57" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_mnist</code>()</p>
</blockquote>
<p>Helper function to load <code>normalized</code> train and validation MNIST datasets</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_mnist</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">download_data</span><span class="p">(</span><span class="n">MNIST_URL</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;.gz&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="p">((</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">),</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>

    <span class="n">xt</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span><span class="n">xv</span><span class="p">,</span><span class="n">yv</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">normalize</span><span class="p">(</span><span class="n">xt</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">(),</span> <span class="n">yt</span><span class="o">.</span><span class="n">float</span><span class="p">(),</span> <span class="n">normalize</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">xt</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">xt</span><span class="o">.</span><span class="n">std</span><span class="p">())</span><span class="o">.</span><span class="n">float</span><span class="p">(),</span> <span class="n">yv</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xt</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span><span class="n">xv</span><span class="p">,</span><span class="n">yv</span> <span class="o">=</span> <span class="n">get_mnist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_stats" class="doc_header"><code>get_stats</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_stats</code>(<strong><code>data</code></strong>)</p>
</blockquote>
<p>Print mean and standard deviation of given <code>data</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_stats</span><span class="p">(</span><span class="n">xt</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean: 0.00012300178059376776
Std: 1.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Visualization">Visualization<a class="anchor-link" href="#Visualization">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="show_im" class="doc_header"><code>show_im</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L77" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>show_im</code>(<strong><code>image</code></strong>, <strong><code>size</code></strong>=<em><code>28</code></em>)</p>
</blockquote>
<p>Displays 'image' or random 'image' from set if multiple given of given 'size'</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_im</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Matmul">Matmul<a class="anchor-link" href="#Matmul">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="matmul" class="doc_header"><code>matmul</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/basic_operations_01.py#L85" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>matmul</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>
<p>Perform matrix multiplication on <code>a</code> and <code>b</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">matmul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">ar</span><span class="p">,</span> <span class="n">ac</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">br</span><span class="p">,</span> <span class="n">bc</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">ac</span> <span class="o">==</span> <span class="n">br</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span><span class="n">bc</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ar_in</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ar</span><span class="p">):</span>
        <span class="n">c</span><span class="p">[</span><span class="n">ar_in</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">ar_in</span><span class="p">]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">c</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> result = matmul(ims,test_weight)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 739 µs, sys: 583 µs, total: 1.32 ms
Wall time: 731 µs
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_near</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="n">ground_truth</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>good
</pre>
</div>
</div>

</div>
</div>

</div>
</div>
 

