---

title: ResNet 

keywords: fastai
sidebar: home_sidebar

summary: "Fully implemented ResNet architecture from scratch: https://arxiv.org/pdf/1512.03385.pdf"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: ResNet.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Helper">Helper<a class="anchor-link" href="#Helper">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_runner" class="doc_header"><code>get_runner</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/callbacks_05.py#L159" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_runner</code>(<strong><code>callbacks</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Nested-Modules">Nested Modules<a class="anchor-link" href="#Nested-Modules">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We first need to make new classes that allow architectures that aren't straight forward passes through a defined set of layers. This is normally handled in the forward passes of pytorch with autograd. We need to be a bit more clever due to the fact that we need to define our gradients in each module.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NestedModel" class="doc_header"><code>class</code> <code>NestedModel</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/resnet_08.py#L27" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NestedModel</code>() :: <a href="/ModernArchitecturesFromScratch/ModelTraining#Module"><code>Module</code></a></p>
</blockquote>
<p>NestModel that allows for a sequential model to be called withing an outer model</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TestMixingGrads" class="doc_header"><code>class</code> <code>TestMixingGrads</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/resnet_08.py#L42" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TestMixingGrads</code>() :: <a href="/ModernArchitecturesFromScratch/ResNet#NestedModel"><code>NestedModel</code></a></p>
</blockquote>
<p>Test Module so Nested SequentialModels will work</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Testing the gradients and the outputs:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">SequentialModel</span><span class="p">(</span><span class="n">TestMixingGrads</span><span class="p">(),</span> <span class="n">Linear</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">get_mnist_databunch</span><span class="p">()</span>
<span class="n">lf</span> <span class="o">=</span> <span class="n">CrossEntropy</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">adam_opt</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(Layer1): 
SubModel( 
(Layer1): Linear(784, 50)
(Layer2): ReLU()
(Layer3): Linear(50, 25)
)
(Layer2): Linear(25, 10)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">CrossEntropy</span><span class="p">(),</span> <span class="n">Optimizer</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>
<span class="n">run</span> <span class="o">=</span> <span class="n">Runner</span><span class="p">(</span><span class="n">learn</span><span class="p">,</span> <span class="p">[</span><span class="n">CheckGrad</span><span class="p">()])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">run</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>good
good
good
good
good
good
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="ConvLayer">ConvLayer<a class="anchor-link" href="#ConvLayer">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before we can start making ResNets, we first define a few helper modules that abstract some of the layers:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AutoConv" class="doc_header"><code>class</code> <code>AutoConv</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/resnet_08.py#L49" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AutoConv</code>(<strong><code>n_in</code></strong>, <strong><code>n_out</code></strong>, <strong><code>kernel_size</code></strong>=<em><code>3</code></em>, <strong><code>stride</code></strong>=<em><code>1</code></em>) :: <a href="/ModernArchitecturesFromScratch/Convolutions&amp;Pooling#Conv"><code>Conv</code></a></p>
</blockquote>
<p>Automatic resizing of padding based on kernel size to ensure constant dimensions of input to output</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ConvBatch" class="doc_header"><code>class</code> <code>ConvBatch</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/resnet_08.py#L56" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ConvBatch</code>(<strong><code>n_in</code></strong>, <strong><code>n_out</code></strong>, <strong><code>kernel_size</code></strong>=<em><code>3</code></em>, <strong><code>stride</code></strong>=<em><code>1</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/ModernArchitecturesFromScratch/ResNet#NestedModel"><code>NestedModel</code></a></p>
</blockquote>
<p>Performs conv then batchnorm</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ConvLayer" class="doc_header"><code>class</code> <code>ConvLayer</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/resnet_08.py#L63" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ConvLayer</code>(<strong><code>n_in</code></strong>, <strong><code>n_out</code></strong>, <strong><code>kernel_size</code></strong>=<em><code>3</code></em>, <strong><code>stride</code></strong>=<em><code>1</code></em>, <strong><code>leak</code></strong>=<em><code>1</code></em>, <strong><code>Activation</code></strong>=<em><code>'ReLU'</code></em>) :: <a href="/ModernArchitecturesFromScratch/ResNet#NestedModel"><code>NestedModel</code></a></p>
</blockquote>
<p>NestModel that allows for a sequential model to be called withing an outer model</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Identity" class="doc_header"><code>class</code> <code>Identity</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/resnet_08.py#L74" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Identity</code>() :: <a href="/ModernArchitecturesFromScratch/ModelTraining#Module"><code>Module</code></a></p>
</blockquote>
<p>Module to perform the identity connection (what goes in, comes out)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="ResBlocks">ResBlocks<a class="anchor-link" href="#ResBlocks">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Final built up ResNet blocks that implement the skip connecton layers characteristic of a ResNet</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BaseRes" class="doc_header"><code>class</code> <code>BaseRes</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/resnet_08.py#L81" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BaseRes</code>(<strong><code>expansion</code></strong>, <strong><code>n_in</code></strong>, <strong><code>n_h</code></strong>, <strong><code>stride</code></strong>=<em><code>1</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/ModernArchitecturesFromScratch/ModelTraining#Module"><code>Module</code></a></p>
</blockquote>
<p>Resblock Layer: ConvBnActivation layer with a skip connection between inputs and outputs, dynamically changes sizing</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ResBlock" class="doc_header"><code>class</code> <code>ResBlock</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/resnet_08.py#L117" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ResBlock</code>(<strong><code>expansion</code></strong>, <strong><code>n_in</code></strong>, <strong><code>n_h</code></strong>, <strong><code>stride</code></strong>=<em><code>1</code></em>, <strong><code>kernel_size</code></strong>=<em><code>3</code></em>, <strong><code>Activation</code></strong>=<em><code>'ReLU'</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/ModernArchitecturesFromScratch/ResNet#NestedModel"><code>NestedModel</code></a></p>
</blockquote>
<p>Adds the final activation after the skip connection addition</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="ResNet">ResNet<a class="anchor-link" href="#ResNet">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="XResNet" class="doc_header"><code>class</code> <code>XResNet</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/resnet_08.py#L127" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>XResNet</code>()</p>
</blockquote>
<p>Class to create ResNet architectures of dynamic sizing</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NestedSequentialModel" class="doc_header"><code>class</code> <code>NestedSequentialModel</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/resnet_08.py#L158" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NestedSequentialModel</code>(<strong>*<code>args</code></strong>) :: <a href="/ModernArchitecturesFromScratch/ModelTraining#SequentialModel"><code>SequentialModel</code></a></p>
</blockquote>
<p>Model for executing forward and backward passes on a given list of <code>layers</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="GetResnet" class="doc_header"><code>GetResnet</code><a href="https://github.com/BradleyBrown19/ModernArchitecturesFromScratch/tree/master/ModernArchitecturesFromScratch/resnet_08.py#L162" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>GetResnet</code>(<strong><code>size</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Helper function to get ResNet architectures of different sizes</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Testing out the ResNet Architectures:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GetResnet</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="n">c_in</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c_out</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(Layer1): Reshape(1, 28, 28)
(Layer2): ConvBnActivation(1, 16)
(Layer3): ConvBnActivation(16, 64)
(Layer4): ConvBnActivation(64, 64)
(Layer5): MaxPool(ks: 3, stride: 2)
(Layer6): (
(Layer1): ResBlock(64, 64)
(Layer2): ResBlock(64, 64)
)
(Layer7): (
(Layer1): ResBlock(64, 128)
(Layer2): ResBlock(128, 128)
)
(Layer8): (
(Layer1): ResBlock(128, 256)
(Layer2): ResBlock(256, 256)
)
(Layer9): (
(Layer1): ResBlock(256, 512)
(Layer2): ResBlock(512, 512)
)
(Layer10): AveragePool(ks: 1, stride: 2)
(Layer11): Flatten()
(Layer12): Linear(512, 10)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GetResnet</span><span class="p">(</span><span class="mi">34</span><span class="p">,</span> <span class="n">c_in</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c_out</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(Layer1): Reshape(1, 28, 28)
(Layer2): ConvBnActivation(1, 16)
(Layer3): ConvBnActivation(16, 64)
(Layer4): ConvBnActivation(64, 64)
(Layer5): MaxPool(ks: 3, stride: 2)
(Layer6): (
(Layer1): ResBlock(64, 64)
(Layer2): ResBlock(64, 64)
(Layer3): ResBlock(64, 64)
)
(Layer7): (
(Layer1): ResBlock(64, 128)
(Layer2): ResBlock(128, 128)
(Layer3): ResBlock(128, 128)
(Layer4): ResBlock(128, 128)
)
(Layer8): (
(Layer1): ResBlock(128, 256)
(Layer2): ResBlock(256, 256)
(Layer3): ResBlock(256, 256)
(Layer4): ResBlock(256, 256)
(Layer5): ResBlock(256, 256)
(Layer6): ResBlock(256, 256)
)
(Layer9): (
(Layer1): ResBlock(256, 512)
(Layer2): ResBlock(512, 512)
(Layer3): ResBlock(512, 512)
)
(Layer10): AveragePool(ks: 1, stride: 2)
(Layer11): Flatten()
(Layer12): Linear(512, 10)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GetResnet</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">c_in</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c_out</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(Layer1): Reshape(1, 28, 28)
(Layer2): ConvBnActivation(1, 16)
(Layer3): ConvBnActivation(16, 64)
(Layer4): ConvBnActivation(64, 64)
(Layer5): MaxPool(ks: 3, stride: 2)
(Layer6): (
(Layer1): ResBlock(16, 256)
(Layer2): ResBlock(64, 256)
(Layer3): ResBlock(64, 256)
)
(Layer7): (
(Layer1): ResBlock(64, 512)
(Layer2): ResBlock(128, 512)
(Layer3): ResBlock(128, 512)
(Layer4): ResBlock(128, 512)
)
(Layer8): (
(Layer1): ResBlock(128, 1024)
(Layer2): ResBlock(256, 1024)
(Layer3): ResBlock(256, 1024)
(Layer4): ResBlock(256, 1024)
(Layer5): ResBlock(256, 1024)
(Layer6): ResBlock(256, 1024)
)
(Layer9): (
(Layer1): ResBlock(256, 2048)
(Layer2): ResBlock(512, 2048)
(Layer3): ResBlock(512, 2048)
)
(Layer10): AveragePool(ks: 1, stride: 2)
(Layer11): Flatten()
(Layer12): Linear(2048, 10)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GetResnet</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="n">c_in</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c_out</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(Layer1): Reshape(1, 28, 28)
(Layer2): ConvBnActivation(1, 16)
(Layer3): ConvBnActivation(16, 64)
(Layer4): ConvBnActivation(64, 64)
(Layer5): MaxPool(ks: 3, stride: 2)
(Layer6): (
(Layer1): ResBlock(16, 256)
(Layer2): ResBlock(64, 256)
(Layer3): ResBlock(64, 256)
)
(Layer7): (
(Layer1): ResBlock(64, 512)
(Layer2): ResBlock(128, 512)
(Layer3): ResBlock(128, 512)
(Layer4): ResBlock(128, 512)
)
(Layer8): (
(Layer1): ResBlock(128, 1024)
(Layer2): ResBlock(256, 1024)
(Layer3): ResBlock(256, 1024)
(Layer4): ResBlock(256, 1024)
(Layer5): ResBlock(256, 1024)
(Layer6): ResBlock(256, 1024)
(Layer7): ResBlock(256, 1024)
(Layer8): ResBlock(256, 1024)
(Layer9): ResBlock(256, 1024)
(Layer10): ResBlock(256, 1024)
(Layer11): ResBlock(256, 1024)
(Layer12): ResBlock(256, 1024)
(Layer13): ResBlock(256, 1024)
(Layer14): ResBlock(256, 1024)
(Layer15): ResBlock(256, 1024)
(Layer16): ResBlock(256, 1024)
(Layer17): ResBlock(256, 1024)
(Layer18): ResBlock(256, 1024)
(Layer19): ResBlock(256, 1024)
(Layer20): ResBlock(256, 1024)
(Layer21): ResBlock(256, 1024)
(Layer22): ResBlock(256, 1024)
(Layer23): ResBlock(256, 1024)
)
(Layer9): (
(Layer1): ResBlock(256, 2048)
(Layer2): ResBlock(512, 2048)
(Layer3): ResBlock(512, 2048)
)
(Layer10): AveragePool(ks: 1, stride: 2)
(Layer11): Flatten()
(Layer12): Linear(2048, 10)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GetResnet</span><span class="p">(</span><span class="mi">152</span><span class="p">,</span> <span class="n">c_in</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c_out</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(Layer1): Reshape(1, 28, 28)
(Layer2): ConvBnActivation(1, 16)
(Layer3): ConvBnActivation(16, 64)
(Layer4): ConvBnActivation(64, 64)
(Layer5): MaxPool(ks: 3, stride: 2)
(Layer6): (
(Layer1): ResBlock(16, 256)
(Layer2): ResBlock(64, 256)
(Layer3): ResBlock(64, 256)
)
(Layer7): (
(Layer1): ResBlock(64, 512)
(Layer2): ResBlock(128, 512)
(Layer3): ResBlock(128, 512)
(Layer4): ResBlock(128, 512)
(Layer5): ResBlock(128, 512)
(Layer6): ResBlock(128, 512)
(Layer7): ResBlock(128, 512)
(Layer8): ResBlock(128, 512)
)
(Layer8): (
(Layer1): ResBlock(128, 1024)
(Layer2): ResBlock(256, 1024)
(Layer3): ResBlock(256, 1024)
(Layer4): ResBlock(256, 1024)
(Layer5): ResBlock(256, 1024)
(Layer6): ResBlock(256, 1024)
(Layer7): ResBlock(256, 1024)
(Layer8): ResBlock(256, 1024)
(Layer9): ResBlock(256, 1024)
(Layer10): ResBlock(256, 1024)
(Layer11): ResBlock(256, 1024)
(Layer12): ResBlock(256, 1024)
(Layer13): ResBlock(256, 1024)
(Layer14): ResBlock(256, 1024)
(Layer15): ResBlock(256, 1024)
(Layer16): ResBlock(256, 1024)
(Layer17): ResBlock(256, 1024)
(Layer18): ResBlock(256, 1024)
(Layer19): ResBlock(256, 1024)
(Layer20): ResBlock(256, 1024)
(Layer21): ResBlock(256, 1024)
(Layer22): ResBlock(256, 1024)
(Layer23): ResBlock(256, 1024)
(Layer24): ResBlock(256, 1024)
(Layer25): ResBlock(256, 1024)
(Layer26): ResBlock(256, 1024)
(Layer27): ResBlock(256, 1024)
(Layer28): ResBlock(256, 1024)
(Layer29): ResBlock(256, 1024)
(Layer30): ResBlock(256, 1024)
(Layer31): ResBlock(256, 1024)
(Layer32): ResBlock(256, 1024)
(Layer33): ResBlock(256, 1024)
(Layer34): ResBlock(256, 1024)
(Layer35): ResBlock(256, 1024)
(Layer36): ResBlock(256, 1024)
)
(Layer9): (
(Layer1): ResBlock(256, 2048)
(Layer2): ResBlock(512, 2048)
(Layer3): ResBlock(512, 2048)
)
(Layer10): AveragePool(ks: 1, stride: 2)
(Layer11): Flatten()
(Layer12): Linear(2048, 10)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">run</span> <span class="o">=</span> <span class="n">get_runner</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">GetResnet</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="n">c_in</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c_out</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">run</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>
 

